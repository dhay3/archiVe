# Burpsuite 02 - Tools and Terms

## 0x01 Overview

简单的记录一下 Burp 中各组件的功能，按照选项卡分类（例如 Burp browser 在 Proxy 选项卡下就算一类）

## 0x02 Dashboard

Burp's Dashboard[^1] tab provides a central location for monitoring and controlling all of the automated tasks in your project. 

Burp’s Dashborad 提供了一组自动化任务，以及一些面板记录日志信息，包括 issues, event logs 等

- Crawl tasks that automate the process of mapping the available attack  surface by browsing the target website just like a real user. For more  information, see [Crawling](https://portswigger.net/burp/documentation/scanner/crawling).
- Full vulnerability scans that both crawl the target website and audit  the discovered attack surface for security issues. For more information, see [Automated scanning](https://portswigger.net/burp/documentation/desktop/automated-scanning).
- Live tasks that perform various crawling and auditing operations using  the traffic you generate while manually browsing the target website. For more information, see [Live tasks](https://portswigger.net/burp/documentation/desktop/automated-scanning/live-tasks).

## 0x01 Proxy

Burp Proxy[^2] operates as a web proxy server between the browser and target applications. It enables you to intercept, inspect, and modify traffic  that passes in both directions. You can even use this to test using  HTTPS.        

Proxy 是 Burp 中一个核心的组件，浏览器只有使用对应的 Burp proxy 地址（默认为 http://127.0.0.1:8080），才会将流量发送到 Burp，实现 MITM

组件提供了如下常用的接口和功能

- intercept

  Intercept HTTP requests and responses between the browser and the target server

  1. Intercept a request and modify it before forwarding it to the server.            
  2. Send interesting requests to Burp's other tools, such as Repeater or Intruder, for further testing.            
  3. Drop a request to prevent it from reaching the server.            

- HTTP history

  A record of the HTTP traffic that passed through Burp Proxy

### Burp’s browser

Burp’s browser[^3] 是 Burp 里内置的浏览器，已经预设了 Proxy 和 TLS 配置，开箱即用

## 0x03 Target

The Target tool enables you to define which targets are in scope for your current work. It also contains the site map and **Crawl paths** tab, which show you detailed information about your target applications.

Target 可以让用户专注一个测试目标

### sitemap

The site map shows the information that Burp collects as you explore  your target application. It builds a hierarchical representation of the  content from a number of sources. These include information from scans,  and the URLs you discover as you browse the target manually. 

sitemap 记录了 Burp 收集关于 target 的信息，主要有如下几种

1. A list of the contents under the site

   可以使用 engagement tool 做目录以及接口遍历（逻辑上有点像 selenium）

2. Full requests and responses for individual items

3. Full information about any security issues that Burp discovers

### Crawl paths

The **Crawl paths** tab shows the results of this process  in real time, displaying the actions taken by Burp Scanner to reach each location discovered in the target site, and any issues found in those  locations.

简单的可以将 Crawl paths 理解成是 scan 任务的实时监控

### Issue defintions

Issues 的所有定义       

## 0x04 Intruder

Burp Intruder is a tool for automating customized attacks against web  applications. It enables you to configure attacks that send the same  HTTP request over and over again, inserting different payloads into  predefined positions each time.        

Intruder 是 Burp 的最复杂的一个模块，用于自动化攻击

### payload types

You can set the type of payload that you want to inject into the base request.

可以通俗理解为，payload types[^4] 用于告诉 Burp 该如何生成字典，主要有如下几种 payload types(具体信息查看官方文档)

#### simple list

最简单最常见的字典，由字符构成,例如

```
alice
bob
nija
```

#### runtime file

和 simple list 类似，但是在运行 burpsuite 时才会读取字典

在使用 large payload 文件时非常有效

#### custom iterator

custom iterator 可以允许，在不同的 payload postion 使用不同的 payload set

#### character substitution

字符变体，例如 `e > 3` 和 `t > 7`，字典中有 `peter`，就会生成如下 payloads

```
peter
p3ter
pe7er
p37er
pet3r
p3t3r
pe73r
p373r
```

#### case modification

大小写变体，有如下几种变体规则

- No change - No modification.            
- To lower case - All letters are converted to lower case.            
- To upper case - All letters are converted to upper case.            
- To Propername - The first letter is converted to upper case, and subsequent letters are converted to lower case.            
- To ProperName - The first letter is converted to upper case, and subsequent letters are not changed.            

例如字典中有 `Peter Wiener`，并选择所有变体，就生成如下 payloads

```
Peter Wiener
peter wiener
PETER WIENER
Peter wiener
```

#### recursive grep

This enables you to extract text from the response to the previous request, and use it as the payload for the current request.   

使用 response 作为 payload，以此递归循环，==需要在 settings Grep Match/Extract/Payloads 中设置，并在 Resource pool 中并将 Maximum concurrent requests 置为 1 才可以使用==

通常用于 SQL 注入，获取表结构

#### illegal unicode

This enables you to generate payloads from a list of items by replacing a specified character with illegal Unicode-encodings of another  character.        

#### character blocks

使用指定数量的字符作为 payload，主要被用在如下两种场景

- Detect buffer overflow and other boundary condition vulnerabilities in software running in a native (unmanaged) context.
- Exploit some [logic flaws](https://portswigger.net/web-security/logic-flaws) where input of a particular length bypasses input filters or triggers an unexpected code path.

有如下几个参数

- Base string - The input string, from which the character blocks will be generated..            
- Min length - The base string is multiplied by this number to generate the smallest block.            
- Max length - The base string is multiplied by this number to generate the largest block.            
- Step - The increment in the length of each character block.            

#### numbers

使用数字作为 payload，主要被用在如下两种场景

- Data mining, for example, trawling an order book for entries placed on different days.
- Brute forcing, for example, guessing the date of birth component of a user's credentials.

有如下几个参数

- Type - Specify whether numbers are generated sequentially, or at random.            
- From - Specify the first number that is generated sequentially. Otherwise, the smallest number that may be randomly generated.            
- To - Specify the last number that is  generated sequentially, or nearest lower increment of the step value.  Otherwise, the largest number that may be randomly generated.            
- Step - Specify the increment between  sequentially generated successive numbers. The value may be negative, in which case the numbers generated will step downwards.            
- How many - The number of payloads that will be randomly generated. Note that duplicate payloads may be generated.            

#### dates

使用日期作为 payload

有如下几个参数

- From - Set the first (and earliest) date that will be generated.            
- To -  Set the value of the last (and latest) date that will be generated (or the nearest lower increment of the step value).            
- Step - Set the increment between successive dates, in days, weeks, months or years. It must be a positive value.            
- Format - Set the format in which the  dates should be represented. Several predefined date formats can be  selected, or a custom format can be entered. The examples below  illustrate the syntax that can be used to specify custom date formats.            

#### burte force

This enables you to generate payloads of specified lengths that contain all permutations of a specified character set.  

字符集的指定长度的所有排列组合作为 payload

有如下几个参数

- Character set - Specify the set of  characters to be used in the payloads. Note that the total number of  payloads increases exponentially with the size of this set.            
- Min length - Set the length of the shortest payload.            
- Max length - Set the length of the longest payload.            

#### null payloads

使用空字符作为 payload

主要被用于如下场景

- Harvesting cookies for sequencing analysis.
- Application-layer denial-of-service attacks where requests are repeatedly sent which initiate high-workload tasks on the server.
- Keeping alive a session token that is being used in other intermittent tests.

#### character frobber

The attack cycles through each item in turn, one character at a time, incrementing the ASCII code of that character by one.

遍历 enclosed-text，对单字符做 ASCII code 加一的操作

例如 enclosed-text 为 `po1`

就会生成如下 payloads

```
qo1
pp1
po2
```

通常用于校验 token 是否用作 session track

#### bit flipper

payload 对应位做取反

#### username generator

按照规则生成用户名 payload

例如 例如 items 中有 peter wiener 就会生成多达 115 种 payload

```
peterweiner
peter.wiener
wienerpeter
wiener.peter
peter
wiener
peterw
peter.w
wpeter
w.peter
pwiener
p.wiener
wienerp
wiener.p
...
```

#### ecb block shuffler

具体看文档

#### extension-generated

This enables you to invoke a  [Burp extension](https://portswigger.net/burp/documentation/desktop/extensions) to generate payloads.        

#### copy other payload

将指定位置的 payload 复制到其他的 payload positions

主要有如下两种使用场景

- When two different parameters must always have the same  value in order to hit a target code path (for example, fields for new  and confirm passwords), and you want to use the cluster bomb attack type to manipulate other parameters at the same time.            
- When one parameter value in the request contains a  checksum of another parameter value, which is normally computed by a  client-side script based on user input.            

#### collaborator payloads

具体看文档

### payload position

payload position 是 Burp 中 payload 的占位符，最后会被替换成 payload set 中的 payload，一个完整的 payload position 如下

```
§enclosed-text§
```

enclosed-text 可以是任意字符，但是需要注意的一点是

***During the attack, both the payload markers and any enclosed text are replaced with the payload. If the payload position does not have an assigned payload, the enclosed text is unchanged but the markers are removed.***

正常在 attack 的过程中，会将 payload position(payload markers `§` 以及 enclosed text) 替换成 payload。但是如果 payload position 没有对应的 payload，会将 payload markers 移除，保留 enclosed text

例如 请求如下

```
GET / HTTP/1.1
Host: baidu.com
Intruderpo1: §1§
Intruderpo2: §2§
```

使用 simple list payloads

```
payload1
```

会生成如下两个请求

```
GET / HTTP/1.1
Host: baidu.com
Intruderpo1: payload1
Intruderpo2: 2

GET / HTTP/1.1
Host: baidu.com
Intruderpo1: 1
Intruderpo2: payload1
```

### attack types

To determine the way in which payloads are assigned to payload  positions, you can specify an attack type.

可以通俗理解为， attack types 用于告诉 Burp 该如何使用字典，在那个 payload positions 使用那个 payload



具体生成的 request count 可以在 Payload Sets 设置中看到

![](https://github.com/dhay3/picx-images-hosting/raw/master/20240422/2024-04-22_17-20.2vejgjduhd.webp)

#### snipper

This attack places each payload into each payload position in turn. It uses a single payload set. The total number of requests generated in the attack is the  product of the number of positions and the number of payloads in the payload set. The Sniper attack is useful for fuzzing a number of request parameters individually for common vulnerabilities.

在每个 playload positions 遍历使用 playloads

例如 请求如下

```
GET / HTTP/1.1
Host: baidu.com
Intruderpo1: §1§
Intruderpo2: §2§
```

使用 simple list payloads

```
payload1
payload2
payload3
```

会生成如下 6 个请求 (`{1..3}` 逻辑和 Bash 中的模式扩展相同表示，即 payload1 payload2 payload3)

前 3 个请求 Intruderpo2 为 2 ，因为在 simple list payloads 中没有对应的 payload

```
GET / HTTP/1.1
Host: baidu.com
Intruderpo1: payload{1..3}
Intruderpo2: 2
```

后 3 个请求 Intruderpo2 为 1 ，因为在 simple list payloads 中没有对应的 payload

```
GET / HTTP/1.1
Host: baidu.com
Intruderpo1: 1
Intruderpo2: payload{1..3}
```

伪代码逻辑如下

```
for i:= 0; i < len(payload-positions); i++ {
    for j:=0; j < len(payloads); j++ {
        payload-position[i] = payloads[j]
        dorequest
    }
}
```

最后生成的请求数为 `payload position counts * payload counts`

#### Battering ram

This attack places the same payload into all of the defined  payload positions simultaneously. It uses a single payload set.

在所有的 payload positions 使用相同的 payload

例如 请求如下

```
GET / HTTP/1.1
Host: baidu.com
Intruderpo1: §1§
Intruderpo2: §2§
```

使用 simple list payloads

```
payload1
payload2
```

会生成如下 2 个请求

```
GET / HTTP/1.1
Host: baidu.com
Intruderpo1: payload1
Intruderpo2: payload1
```

```
GET / HTTP/1.1
Host: baidu.com
Intruderpo1: payload2
Intruderpo2: payload2
```

伪代码逻辑如下

```

for i:=0; i < len(payloads); i++ {
	for j:=0; j < len(payload-positions); j++ {
		payload-position[j] = payloads[i]
	}
  dorequest
}
```

最后生成的请求数为 `payload counts`

#### Pitchfork

This attack iterates through a different payload set for  each defined position. Payloads are placed into each position  simultaneously. For example, the first three requests would be:        

- Request one:                

  Position 1 = First payload from Set 1.

  Position 2 = First payload from Set 2.

- Request two:                

  Position 1 = Second payload from Set 1.

  Position 2 = Second payload from Set 2.

- Request three:                

  Position 1 = Third payload from Set 1.

  Position 2 = Third payload from Set 2.

在不同的 payload position 使用不同 payload set 中的 payload，常用与多参数定义一个值(例如 用户密码 鉴权)

例如 请求如下

```
GET / HTTP/1.1
Host: baidu.com
Intruderpo1: §1§
Intruderpo2: §2§
```

payload set1 和 payload set2 均使用 simple list payloads

```
#payload set1
u1
u2

#payload set2
v1
v2
```

会生成如下 2 个请求

```
GET / HTTP/1.1
Host: baidu.com
Intruderpo1: u1
Intruderpo2: v1
```

```
GET / HTTP/1.1
Host: baidu.com
Intruderpo1: u2
Intruderpo2: v2
```

伪代码逻辑如下

```
for i:=0; i < min(len(payload-set)); i++ {
	for j:=0; j < len(payload-positions); j++ {
		#payload-set represent the i payload in the payload-set j
		payload-position[j] = payload-set[j][i]
	}
  dorequest
}
```

最后生成的请求数为 `min(len(payload-set))` 即最小数量的 payload set 

#### cluster bomb

This attack iterates through a different payload set for each defined position. Payloads are placed from each set in turn, so that all  payload combinations are tested. For example, the first three requests  would be:

- Request one:                

  Position 1 = First payload from Set 1.

  Position 2 = First payload from Set 2.

- Request two:                

  Position 1 = First payload from Set 1.

  Position 2 = Second payload from Set 2.

- Request three:                

  Position 1 = First payload from Set 1.

  Position 2 = Third payload from Set 2.

全排序交叉组合

例如 请求如下

```
GET / HTTP/1.1
Host: baidu.com
Intruderpo1: §1§
Intruderpo2: §2§
```

payload set1 和 payload set2 均使用 simple list payloads

```
#payload set1
u1
u2

#payload set2
v1
v2
v3
```

会生成如下 6 个请求

```
GET / HTTP/1.1
Host: baidu.com
Intruderpo1: u1
Intruderpo2: v{1..3}
```

```
GET / HTTP/1.1
Host: baidu.com
Intruderpo1: u2 
Intruderpo2: v{1..3}
```

伪代码逻辑如下

```
不知道咋写 放弃了
```

最后生成的请求数为所有 `len(payload-set)` 的乘积

### payload processing

对 payload 做变体，有如下的 processing rules

- Add prefix - Add a literal prefix before the payload.            
- Add suffix - Add a literal suffix after the payload.            
- Match / replace - Replace any parts of the payload that match a specific regular expression with a literal string.            
- Substring - Extract a sub-portion of the payloads, starting from a specified offset (0-indexed) and up to a specified length.            
- Reverse substring - This functions as  for the substring rule, but the end offset is specified counting  backwards from the end of the payload, and the length is counted  backwards from the end offset.            
- Modify case - Modify the case of the payload, if applicable. The same settings are available as for the [case modification](https://portswigger.net/burp/documentation/desktop/tools/intruder/configure-attack/payload-types#case-modification) payload type.            
- Encode - Encode the payload using various schemes: URL, HTML, Base64, ASCII hex or constructed strings for various platforms.            
- Decode - Decode the payload using various schemes: URL, HTML, Base64 or ASCII hex.            
- Hash - Carry out a hashing operation on the payload.            
- Add raw payload - Add the raw payload  value before or after the current processed value. It is useful, for  example, if you need to submit the same payload in both raw and hashed  form.            
- Skip if matches regex - Skip the  payload if the current processed value matches a specified regular  expression. This is useful, for example, if you know that a parameter  value must have a minimum length and want to skip any values in a list  that are shorter than this length.            
- Invoke Burp extension - Invoke a [Burp extension](https://portswigger.net/burp/documentation/desktop/extensions) to process the payloads. The extension must have registered an Intruder payload processor. You can select the required processor from the list  of available processors that have been registered by currently loaded  extensions.            
- Replace placeholder with base value - Replace any parts of the payload that match `{base}` with the base value of the payload position.            
- Replace placeholder with collaborator payload - Replace any parts of the payload that match a specific regular  expression with a Collaborator payload. You can choose whether to  include the Collaborator server location in the Collaborator payload.            

## 0x05 Repeater

Burp Repeater is a tool that enables you to modify and send an interesting HTTP or WebSocket message over and over.        

Repeater 用于重放请求

功能比较单一不做过多介绍

## 0x06 Collaborator

略

## 0x07 Decoder

用于 decode/encode/hash

## 0x08 Comparer

用于对比 request/response

**references**

[^1]:https://portswigger.net/burp/documentation/desktop/tools/dashboard
[^2]:https://portswigger.net/burp/documentation/desktop/tools/proxy
[^3]:https://portswigger.net/burp/documentation/desktop/tools/burps-browser
[^4]:https://portswigger.net/burp/documentation/desktop/tools/intruder/configure-attack/payload-types

