# Openwrt 旁路由

ref

https://www.tlcement.com/35015.html

https://sspai.com/post/59708

https://www.youtube.com/watch?v=OPG47_wT3XI

https://post.smzdm.com/p/a7dg5pko/ 

## Digest

旁路由并不是一个官网的叫法，正确的叫法应该是 旁路由网关

而所谓的 旁路网关，是指在主路由下的一个旁系网络，他分担了一部分路由的功能，因此被大众简称为 旁路由，本质上他是一个通过 LAN 口与主路由连接的客户端设备

## Advantages

- 可负载性

  如果你的主路由硬件配置过低，无法承担过重的扩展功能，那么旁路由可以用来分担主路由的压力，既不影响网络速度，还可以一定程度优化网络体验

- 可扩展性

  旁路由可以在对当前的网络架构影响最小的情况下，扩展出新的功能，且在配置阶段可以不影响他人使用网络，非常适合在城市里合租的人员优化自己的网络

- 多功能性

  旁路由同样可以安装各种插件，扩展出很多实用的功能，增强上网体验

## Topology

> 以下拓扑均以 光猫 使用桥接模式作为基础。如果光猫还进行路由转发，图中的主路由就是光猫

### T1 设备自行选择网关

不同的设备通过手动指定网关选择使用 主路由 还是 旁路由

![2023-02-21_00-39](https://github.com/dhay3/image-repo/raw/master/20230220/2023-02-21_00-39.3q6ns2z4zvr4.webp)

配置需要如下几步

1. 旁路由设备的 LAN 口与主路由的 LAN 口互联，将连接主路由的主机网卡适配器 IPv4 地址修改成和旁路由同网段的，连接旁路由 Web 管理界面
2. 修改 旁路由和主路由互联 LAN 口 IP 地址成同网段不冲突固定 IP，例如 192.168.1.x
3. 指定旁路由网关为 192.168.1.1，DNS server也设置为 192.168.1.1
4. 需要使用旁路由的设备，只需要将 网关 和 DNS 指向 旁路由 192.168.1.x 即可

1,2 也可以分开做倒叙，先刷好 IP 后接线

具体可以参考

https://www.tlcement.com/35015.html

### T2 所有设备过旁路由

所有设备流量都经过旁路由

![2023-02-21_00-50](https://github.com/dhay3/image-repo/raw/master/20230220/2023-02-21_00-50.5bkj7uczq6ww.webp)

配置需要如下几步

1. 旁路由设备的 LAN 口与主路由的 LAN 口互联，将连接主路由的主机网卡适配器 IPv4 地址修改成和旁路由同网段的，连接旁路由 Web 管理界面
2. 修改 旁路由和主路由互联 LAN 口 IP 地址成同网段不冲突固定 IP，例如 192.168.1.x

3. 指定旁路由网关为 192.168.1.1，DNS server也设置为 192.168.1.1，在高级设置中选择动态 DHCP。即由 旁路由 分配 DHCP iP

如果不再使用 旁路由，只需要断开网线连接，并重启主路由