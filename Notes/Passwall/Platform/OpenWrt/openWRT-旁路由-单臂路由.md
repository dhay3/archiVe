# 家庭网络建设

参考：

https://www.youtube.com/watch?v=OPG47_wT3XI

[TOC]

## 两大宗旨

1. 所有设备统一在一个网段之下，意味着只有一层NAT转换，只有一个负责NAT设备
2. 所有的网络控制功能都应该尽力收归openWRT服务器

## 光猫

> modem又称猫，将传输信息转换成可以传输的信号
>
> 光猫的模式可以通过咨询运营商修改
>
> ==路由器集合了拨号，AP，路由，交换机功能于一身==

<img src="..\..\..\Images\_Net\Snipaste_2020-10-08_10-40-11.png"/>

### #光猫路由模式

> 这里的openWRT是无线AP，内置的openWRT

![Snipaste_2020-10-08_10-42-00](https://github.com/dhay3/image-repo/raw/master/20230210/Snipaste_2020-10-08_10-42-00.1tzr7rq7n05c.webp)

光猫路由模式下，网络里不会有第二个执行NAT功能的服务器，所以我们的openWRT服务器不应该具有NAT功能，==那么它只能是一台网关服务器，也就是一台旁路由（旁路网关）==。不具有NAT功能，只是用单一LAN，不使用WAN口

### #光猫桥接模式

- **主路由**

> 这里可以使用无线AP替代交换机，用剩余的LAN口来连接有线设备
>
> 用软路由的WAN口连接光猫，LAN口连接无线AP
>
> ==小主机需要双网卡==

**注意！！！**如果是千兆网卡，理论传输速度为1024Mbit/s == 128Mbyte/s，相差8倍

<img src="..\..\..\Images\_Net\Snipaste_2020-10-08_11-49-15.png"/>

==openWRT设备应该具有拨号与NAT功能==

- **单臂路由**

  单臂路由承担了路由器的拨号和NAT
  
  > openWRT性能强大时
>
  > 这里同样可以使用无线AP替代交换机。
>
  > LAN口和WAN口使用同一张网卡，无线AP LAN口连接光猫
  >
  > ==小主机只需要单网口==

<img src="..\..\..\Images\_Net\Snipaste_2020-10-08_11-59-09.png"/>

  ==openWRT设备应该具有拨号与NAT功能==，单臂路由是主路由的一种变形



- **旁路由**

  旁路由承担了路由器的网关功能
  
  > 性能不是很强大的openWRT服务器可以考虑搭配优质无线主路由，放弃拨号和NAT功能
>
  > 同样是在光猫桥接模式，交换机同样能被无线AP替代，无线AP的LAN口连接openWRT
>
  > ==小主机单网口==

<img src="..\..\..\Images\_Net\Snipaste_2020-10-08_12-16-32.png"/>

  ==这里的openWRT应该是一台网关服务器，也就是旁路由==，不具备拨号和NAT

## 单臂路由和旁路由的区别

1. 单臂路由是主路由的变形，要执行NAT和拨号，旁路由（网关路由）不需要

2. openWRT设置里有单臂路由有LAN/WAN两接口，旁路由只有LAN口

##  简化路由

- 单臂路由

<img src="..\..\..\Images\_Net\Snipaste_2020-10-08_12-34-48.png"/>

- 旁路由

<img src="..\..\..\Images\_Net\Snipaste_2020-10-08_12-35-47.png"/>
