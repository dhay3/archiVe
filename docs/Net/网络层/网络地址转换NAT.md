# 专用网络/NAT

[TOC]

## 专用网络

专用网络是指，使用私有IP地址空间的网络。==私有IP无法直接连接互联网，需要公网IP转发(通过NAT)==。与公网IP相比，私有IP是免费的，也节省了IP地址资源，适合在局域网使用。私有IP地址在internet中不会被分配。

## NAT

网络地址转换 NAT (Network Address Translation)  方法于1994年提出。

- 需要在专用网连接到互联网的路由器上安装 NAT 软件。装有 NAT 软件的路由器叫做 NAT路由器，它至少有一个有效的外部全球IP地址。
- 所有使用本地地址的主机在和外界通信时，都要在 ==NAT 路由器上将其本地地址转换成全球 IP 地址==，才能和互联网连接。  

<img src="..\..\..\..\imgs\_Net\计算机网络\Snipaste_2020-08-23_19-07-15.png" style="zoom:80%;" />

注意专用网可以通过NAT访问到互联网，但是互联网中其他IP不能访问到专用网。例如：配置了NAT的虚拟机可以访问外网，但是外网不能ping虚拟机

以vmnet8 NAT模式为例, 当虚拟机发送数据报时如果目的地址是同一网段, 通过DHCP的广播地址, 如果不同网段通过vmnet8 交换机的网关, 将源地址转为宿主机的全球IP地址, 数据返回是, 将目的地址转为虚拟机地址，并不依赖vmware Network Adapter 。宿主机与虚拟机交换信息 ，宿主机发送信息采用vmware Network Adapter 的IP地址然后通过交换机将信息传给虚拟机

可以看出，在内部主机与外部主机通信时，==在NAT路由器上发生了两次地址转换==：
离开专用网时：替换源地址，将内部地址替换为全球地址；
进入专用网时：替换目的地址，将全球地址替换为内部地址；
